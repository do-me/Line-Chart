#############################  
##   Line Chart            ##
##   by do-me 31.05.2018   ##
#############################  

# Data for the chart available at https://www.esrl.noaa.gov/psd/enso/mei/table.html, hardcoded here

valMEI<- c(-1.03,-1.133,-1.283,-1.071,-1.445,-1.376,-1.267,-1.03,-.597,-.406,-1.138,-1.235
       ,-1.049,-1.152,-1.178,-.511,-.374,.319,.676,.842,.773,.768,.726,.504
       ,.433,.138,.071,.224,-.307,-.722,-.307,-.358,.347,.306,-.328,-.098
       ,.044,.401,.277,.687,.773,.226,.379,.228,.527,.124,.099,.351
       ,-.036,-.027,.154,-.616,-1.478,-1.528,-1.356,-1.446,-1.138,-1.32,-1.113,-1.088
       ,-.74,-.669,-1.117,-1.621,-1.663,-2.209,-1.977,-2.043,-1.803,-1.725,-1.813,-1.846
       ,-1.408,-1.275,-1.371,-1.216,-1.316,-1.49,-1.245,-1.106,-1.327,-1.461,-1.014,-.993
       ,-.915,-.348,.108,.383,.826,.753,.924,1.157,1.158,1.114,1.167,1.268
       ,1.473,1.454,1.313,.991,.685,.841,.7,.442,.209,.237,.501,.691
       ,.553,.81,.502,.202,-.026,-.036,-.112,.13,.126,-.038,-.151,-.247
       ,-.287,-.253,-.082,.007,-.321,-.254,-.318,-.233,-.439,-.332,-.308,-.39
       ,-.15,-.235,-.073,.017,-.304,-.153,-.21,-.283,-.271,-.51,-.416,-.608
       ,-1.065,-.963,-.692,-1.04,-.894,-.839,-.682,-.523,-.528,-.642,-.598,-.482
       ,-.718,-.837,-.675,-.761,-.48,-.112,.403,.611,.778,.848,.866,.765
       ,.878,.481,-.256,-.545,-1.249,-1.113,-1.386,-1.476,-1.284,-1.196,-1.211,-.907
       ,-.536,-.329,-.259,.086,.474,.895,1.366,1.452,1.43,1.25,1.378,1.27
       ,1.307,1.186,.689,.515,-.178,-.169,-.116,.171,-.06,-.018,.022,-.181
       ,-.462,-.898,-1.05,-1.03,-.453,-.217,-.489,-.376,-.601,-.655,-.407,-.357
       ,-.602,-.727,-.635,-.944,-1.106,-.777,-.503,-.087,.244,.46,.607,.367
       ,.67,.849,.458,.622,.681,.823,.49,.232,.2,.537,.683,.417
       ,.38,.432,.228,.014,-.097,-.608,-1.053,-.995,-1.226,-1.068,-1.063,-1.203
       ,-1.204,-1.507,-1.79,-1.839,-1.444,-1.392,-1.206,-1.201,-1.439,-1.399,-1.301,-.969
       ,-.575,-.398,-.256,-.166,.428,.995,1.824,1.828,1.574,1.667,1.74,1.787
       ,1.723,1.515,.87,.491,-.096,-.728,-1.057,-1.323,-1.712,-1.65,-1.482,-1.826
       ,-1.912,-1.768,-1.743,-1.62,-1.061,-.663,-.751,-.649,-.599,-1.031,-1.23,-.886
       ,-.522,-.576,-.85,-.927,-.841,-1.115,-1.498,-1.704,-1.853,-1.968,-1.748,-1.732
       ,-1.587,-1.366,-1.213,-1.157,-.486,.306,.634,.676,1.064,.978,.511,.565
       ,.529,.29,.145,.552,.318,.443,.888,.706,.824,1.016,.99,.877
       ,.777,.912,.935,.199,-.381,-.575,-.421,-.182,-.364,.003,.203,.406
       ,.608,.379,.002,.301,.382,.453,.397,.637,.801,.694,.759,1.004
       ,.677,.601,.684,.912,.966,.931,.768,.349,.302,.223,.27,.111
       ,-.25,-.14,.455,.669,.189,.004,-.027,-.072,.209,.132,-.021,-.126
       ,-.258,-.125,.1,.008,.445,.947,1.613,1.806,1.835,2.061,2.441,2.425
       ,2.677,2.931,3.008,2.812,2.538,2.255,1.792,1.184,.507,.056,-.115,-.17
       ,-.314,-.509,.151,.39,.189,-.023,-.054,-.138,-.085,.026,-.332,-.585
       ,-.546,-.576,-.696,-.468,-.715,-.14,-.126,-.35,-.508,-.119,-.042,-.279
       ,-.293,-.183,.028,-.107,.355,.301,.402,.787,1.116,1.002,.89,1.202
       ,1.249,1.218,1.716,1.855,2.134,1.975,1.878,2.003,1.905,1.671,1.286,1.293
       ,1.115,.716,.495,.389,.196,-.556,-1.107,-1.284,-1.501,-1.313,-1.447,-1.311
       ,-1.103,-1.241,-1.035,-.76,-.402,-.216,-.429,-.479,-.287,-.319,-.058,.131
       ,.243,.573,.951,.46,.658,.527,.151,.145,.398,.303,.4,.362
       ,.319,.323,.399,.449,.748,1.074,1.044,1.031,.778,1.031,1.202,1.34
       ,1.747,1.886,1.985,2.247,2.112,1.75,1.048,.58,.518,.663,.595,.664
       ,.692,.99,.987,1.408,2.019,1.635,1.206,1.05,1.011,1.09,.848,.595
       ,.352,.193,.159,.465,.585,.819,.907,.783,.931,1.437,1.312,1.251
       ,1.219,.959,.845,.453,.576,.53,.234,-.13,-.416,-.461,-.463,-.537
       ,-.597,-.566,-.236,-.391,-.044,.111,-.173,-.358,-.426,-.338,-.134,-.325
       ,-.48,-.605,-.248,.527,1.14,2.287,2.827,3.037,3.057,2.423,2.551,2.344
       ,2.455,2.777,2.751,2.658,2.237,1.356,.392,-.319,-.6,-.789,-1.069,-.908
       ,-1.039,-1.123,-.95,-.88,-.601,-.31,-.477,-.725,-.937,-.954,-1.031,-1.142
       ,-1.122,-1.189,-1.09,-.397,.257,.02,-.157,-.129,-.21,-.367,-.701,-.55
       ,-.496,-.649,-.548,-.05,.288,.071,.299,.35,-.147,-.255,-.138,.033
       ,.017,-.16,-.118,.401,.891,.945,.716,1.025,.921,1.02,1.101,1.156
       ,1.214,.944,.83,.413,.214,.131,.178,.329,.492,.534,.584,.362
       ,.332,.37,-.036,.358,.56,.327,.574,.639,.591,.524,.818,.684
       ,.325,.816,1.057,.626,.893,.612,.519,.362,.329,-.152,-.374,-.55
       ,-.428,-.414,-.521,-.571,.043,.546,.718,.77,.84,.976,1.297,.965
       ,.985,.537,.125,.026,.354,-.136,-.247,-.427,-1.175,-1.204,-1.149,-1.178
       ,-1.006,-1.371,-1.552,-.858,-.349,.164,.089,-.252,-.545,-.681,-.584,-.646
       ,-.714,-.69,-.705,-.106,.328,.779,1.06,1.073,.745,.924,1.134,1.059
       ,1.066,1.526,1.462,.978,.668,-.211,-1.099,-1.662,-1.86,-1.888,-1.472,-1.558
       ,-1.719,-1.544,-1.554,-1.387,-.202,.016,-.191,-.502,-.751,-.917,-.933,-.945
       ,-.98,-.675,-.382,.11,.769,.866,1.128,.628,.351,.097,.141,.111
       ,.103,-.068,-.026,.09,.203,-.078,-.311,-.466,-.125,.148,-.042,-.234
       ,-.27,-.259,.018,.295,1.01,1.057,.921,.961,.593,.45,.773,.566
       ,.417,.464,.614,.916,1.592,2.101,1.987,2.365,2.532,2.256,2.3,2.12
       ,2.216,2.17,1.963,2.094,1.77,1.069,.354,.186,-.091,-.363,-.197,-.11
       ,-.052,-.043,-.08,.744,1.455,1.049,.461,.027,-.449,-.551,-.277,-.576
       ,-.623,-.731,-.502,-.432)

MEI <- ts(valMEI, frequency=12, start=c(1950,1)) # useful time series (ts) function!

Years <- seq(as.Date("1950/1/1"), by = "month", length.out = 820) # only needed for hardcoded x axis


lin.mod <- lm(MEI~Years) # trend line
pr.lm <- predict(lin.mod)

plot(Years, MEI, "l", las=1,xaxt='n') #xaxt=n to suppress x vals; plots the graph
lines(pr.lm~Years, col="blue", lwd=2)

xmin<-min(Years,na.rm=T);xmax<-max(as.Date('2020/1/1'),na.rm=T) # these three lines only used for x axis plot
xseq<-seq.Date(xmin,xmax,by='10 years')
axis.Date(side=1,at=xseq,format='%Y',las=1)

abline(h = 0, col = "gray60", lty=2) # create grid through single lines with x and y values
abline(h = 1, col = "gray60", lty=2)
abline(h = 2, col = "gray60", lty=2)
abline(h = 3, col = "gray60", lty=2)
abline(h = -1, col = "gray60", lty=2)
abline(h = -2, col = "gray60", lty=2)

abline(v=0, col = "gray60", lty=2)
abline(v=-3650, col = "gray60", lty=2) #trial and error based y values, as time series makes it complicated
abline(v=-7300, col = "gray60", lty=2) 
abline(v=3650, col = "gray60", lty=2) 
abline(v=7300, col = "gray60", lty=2) 
abline(v=10950, col = "gray60", lty=2) 
abline(v=14600, col = "gray60", lty=2) 
abline(v=18250, col = "gray60", lty=2) 
